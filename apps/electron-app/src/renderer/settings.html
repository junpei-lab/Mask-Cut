<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mask-Cut 設定</title>
    <style>
      :root {
        color-scheme: light dark;
        font-family: 'Segoe UI', 'Hiragino Sans', system-ui, sans-serif;
      }

      body {
        margin: 0;
        padding: 24px;
        background: #0f1115;
        color: #f5f5f5;
        min-height: 100vh;
        box-sizing: border-box;
      }

      h1 {
        margin: 0 0 8px;
      }

      p.description {
        margin: 0 0 24px;
        color: #94a3b8;
      }

      form {
        display: flex;
        flex-direction: column;
        gap: 16px;
      }

      .field {
        display: flex;
        flex-direction: column;
        gap: 4px;
      }

      label {
        font-weight: 600;
        font-size: 0.95rem;
      }

      input,
      select,
      textarea {
        border-radius: 8px;
        border: 1px solid #2c323a;
        padding: 10px;
        font-size: 0.95rem;
        background: #1b1f24;
        color: inherit;
      }

      input:disabled {
        opacity: 0.6;
      }

      .field-hint {
        font-size: 0.8rem;
        color: #94a3b8;
      }

      .field-error {
        font-size: 0.8rem;
        color: #f87171;
        min-height: 18px;
      }

      .actions {
        display: flex;
        gap: 8px;
        justify-content: flex-end;
        margin-top: 8px;
      }

      button {
        border: none;
        border-radius: 8px;
        padding: 10px 16px;
        font-size: 0.95rem;
        font-weight: 600;
        cursor: pointer;
      }

      button.primary {
        background: linear-gradient(120deg, #4f46e5, #7c3aed);
        color: white;
      }

      button.secondary {
        background: #232832;
        color: #e2e8f0;
      }

      button:disabled {
        opacity: 0.6;
        cursor: not-allowed;
      }

      .status {
        border-radius: 10px;
        padding: 12px 16px;
        font-size: 0.9rem;
        background: rgba(148, 163, 184, 0.15);
        color: #e2e8f0;
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 12px;
      }

      .status[data-tone='success'] {
        background: rgba(74, 222, 128, 0.15);
        color: #bbf7d0;
      }

      .status[data-tone='error'] {
        background: rgba(248, 113, 113, 0.15);
        color: #fecaca;
      }

      .last-updated {
        font-size: 0.85rem;
        color: #94a3b8;
      }
    </style>
  </head>
  <body>
    <h1>接続設定</h1>
    <p class="description">
      エンドポイントとモデル、API キー参照 ID を管理します。保存すると次回のマスキングリクエストにすぐ反映されます。
    </p>

    <div id="status" class="status" data-tone="info">
      <span id="status-text">設定を読み込み中です…</span>
      <span id="last-updated" class="last-updated"></span>
    </div>

    <form id="settings-form">
      <div class="field">
        <label for="endpoint-url">エンドポイント URL</label>
        <input id="endpoint-url" name="endpointUrl" type="url" autocomplete="off" />
        <span class="field-error" data-error-for="endpointUrl"></span>
      </div>

      <div class="field">
        <label for="model-name">モデル名</label>
        <input id="model-name" name="modelName" type="text" autocomplete="off" />
        <span class="field-error" data-error-for="modelName"></span>
      </div>

      <div class="field">
        <label for="vault-key-id">API キー参照 ID</label>
        <input id="vault-key-id" name="vaultKeyId" type="text" autocomplete="off" />
        <span class="field-hint">keytar に保存された資格情報を参照する ID です。</span>
        <span class="field-error" data-error-for="vaultKeyId"></span>
      </div>

      <div class="field">
        <label for="api-key">API キー (必要に応じて更新)</label>
        <input id="api-key" name="apiKey" type="password" autocomplete="off" placeholder="新しいキーを入力" />
        <span class="field-hint">空のまま保存すると既存のキーを維持します。</span>
      </div>

      <div class="field">
        <label for="timeout-ms">タイムアウト (ミリ秒)</label>
        <input id="timeout-ms" name="timeoutMs" type="number" min="1000" step="1000" />
        <span class="field-error" data-error-for="timeoutMs"></span>
      </div>

      <div class="actions">
        <button type="button" id="close-button" class="secondary">閉じる</button>
        <button type="submit" id="save-button" class="primary">保存する</button>
      </div>
    </form>

    <script type="module" src="./settings.js"></script>
  </body>
</html>
